/*
 * @Author: fanqian
 * @Date:   2016-06-15 12:34:55
 * @Website:   Administrator
 * @使用请注明作者和网站
 */
$.QianLoad = {
	PageLoading: function(options) {
		var defaults = {
			delayTime: 1000, //页面加载完成后，加载进度条淡出速度
			sleep: 0, //设置挂起,等于0时则无需挂起
			css: '<style>.load-container{margin-top:0px;opacity:1;width:100%;height:100%;position:fixed;top:0;left:0;background:#46cac8;z-index:9999999; transition:all 1s ease 0s; }.load-container.yichu {opacity:0; top:-100%;}.yemian {width:100%; margin:0 auto; overflow:hidden;}#inside-load{position:absolute; top:0%;width:100%; height:100%;background:#ff2a00;}@keyframes pulse{30%{opacity:.6}60%{opacity:0}to{opacity:.6}}</style>'
			//设置挂起,等于0时则无需挂起
		};
		var options = $.extend(defaults, options);
		//在页面未加载完毕之前显示的loading Html自定义内容
		$('head').append(defaults.css);
		var _LoadingHtml = '';
		//呈现loading效果
		$("body").append(_LoadingHtml);
		//监听页面加载状态
		document.onreadystatechange = PageLoaded;
		function PageLoaded() {
			var loadingMask = $('#inside-load');
			$({
				property: 0
			}).animate({
				property: 98
			}, {
				duration: 3000,
				step: function() {
					var percentage = Math.round(this.property);
					loadingMask.css('width', "100%");
					// loadingMask.css('width', percentage + "%");
					//页面加载后执行
					if (document.readyState == "complete") {
						loadingMask.css('width', 100 + "%");
						loadingMask.css('top', 0 + "%");
						setTimeout(function() {
								loadingMask.animate({
										"opacity": 0
									},
									options.delayTime,
									function() {
										setTimeout(function() {
												$('.load-container').addClass("yichu"); //页面加载后的消失样式
												console.log('Loading has been successful');
											},
											0)

									});
							},
							options.sleep);
					}
				}
			})
		}
	}
}
